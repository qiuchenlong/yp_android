<!DOCTYPE html>
<html ng-app="myApp" class="htmlWeiLei">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title>小说分类</title>
    <link href="../css/swiper.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="../css/api.css" />
    <link rel="stylesheet" href="../src/css/icon/iconfont.css">
    <link rel="stylesheet" href="../src/css/index.css">
    <script src="../src/library/zepto.js"></script>
    <!--页面js-->
    <script src="../src/js/global.js"></script>
    <style type="text/css">
        *{margin: 0;padding: 0;}
        .top{
            height: 40px;
            background: #fff;
            top: -5px;
        }
        .search{
            float: left;
            width: 90%;
            margin-top: 5px;
            margin-left: 5%;
        }
        .searchInput{
            width: 100%;
            background: url(../image/zui_search_ico.png) no-repeat 10px #f3f3f3;
            background-size: 16px;
            background-position: 30%;
            height: 25px !important;
            line-height: 25px;
            font-size: 12px !important;
            border: none;
            border: 1px solid #ccc;
            border-radius: 30px;
            outline: none;
            color: #666;
            text-align: center;
        }
        .classify{
            padding: 15px 0 0;
            background: white;
        }
        .classify ul li{
            float: left;
            width: 20%;
            text-align: center;
            font-size: 14px;
            color: #484848;
        }
        .classify ul li img{
            width: 50%;
            height: 30px;
        }
        .bookList{
            background: white;
        }
        .bookList ul li{
            float: left;
            width: 32.5%;
            text-align: center;
            font-size: 14px;
        }
        .bookList ul li img{
            width: 80%;
        }
        .bookList ul li .bookName{
            width: 70%;
            margin: 10px auto;
            font-size: 12px;
            color: #676767;
            height: 26px;
            line-height: 13px;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        .title{
            font-size: 16px;
            /*line-height:45px;*/
            padding: 12px 0;
            padding-left: 10px;
            color: #484848;
            font-weight: 600
        }
        .booksList2{
            background: white;
            margin-top: 5px;
            padding: 0 10px 5px 10px;
        }
        .booksList2 ul li{
            border-bottom: 1px solid #f3f3f3;
            padding: 14px 0;
        }
        .booksList2 ul li:last-child{
            border-bottom: 0;
        }
        .booksList2 ul li .bookCover{
            float: left;
            width: 20%;
        }
        .booksList2 ul li .bookCover img{
            width: 1.26rem;
            height: 1.76rem;
            box-shadow: 0 0 0.12rem #646464;
            -webkit-box-shadow: 0 0 0.12rem #646464;
        }
        .booksList2 ul li .bookInfo{
            float: left;
            width: 76%;
            margin-left: 3%;
            font-size: 11px;
            color: #787878;
            line-height: 15px;
        }
        .booksList2 ul li .bookInfo .booksName{
            font-size: 0.26rem;
            font-weight: bold;
            color: #484848;
            line-height: 25px;
        }
        .booksList2_title{
            padding: 0;
        }
        #swiper2,
        #swiper1{
            height: 40px;
            line-height: 38px;
            font-size: 14px;
            color: #484848;
            background: white;
            padding: 0 10px;
        }
        .icon-laba{
            font-size: 20px;
            float: left;
            margin-right: 5px;
            color: #494df1;
        }
        .button{
            padding: 10px;
            text-align: center;
        }
        .button span{
            display: inline-block;
            width: 90%;
            text-align: center;
            line-height: 30px;
            border-radius: 3px;
            color: white;
        }
        .txt{
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        .author{
            margin: 8px 0;
            color: #484848;
        }
        .author img{
            width: 10px;
            height: 10px;
            vertical-align: middle;
        }
        .label{
            padding: 1px;
            line-height: 15px;
            border: 1px solid #bbdba8;
            border-radius: 3px;
            color: #bbdba8;
            margin-right: 5px;
        }
        .labels{
            padding: 1px;
            line-height: 15px;
            margin-right: 5px;
            border: 1px solid #99bbda;
            border-radius: 3px;
            color: #99bbda;
        }
        .hotList{
            background: white;
            margin-top: -5px;
        }
        .hotList > ul > li{
            line-height: 40px;
            padding: 0 10px;
            font-size: 14px;
            border-bottom: 1px solid #f1f1f1;
        }
        .hotList > ul > li:last-child{
            border: 0
        }
        .hotList > ul > li .sort{
            width: 24px;
            height: 24px;
            line-height: 25px;
            text-align: center;
            background: #ff3a3a;
            border-radius: 50%;
            color: white;
        }
        .hotList > ul > li .booksName{
            margin-left: 10px;
        }
        .hotList > ul > li .label{
            margin-top: 9px;
        }
        .ad_img{
            width: 100%;
            height: auto;
        }
        /* .redu {
            width: 100%;
            height: 30px;
            line-height: 30px;
            background: #ffffff;
            text-align: left;
            font-size: 14px;
        }

        .redu span {
            min-width: 23%;
            margin-left: 3%;
            line-height: 20px;
            height: 20px;
            text-align: center;
        } */

        .huang_se{
            color: #1ba976;
            border: #1ba976 1px solid;
            border-radius: 15px;
        }
        .top-list{
            overflow: hidden;
            margin: 0;
            padding: 0;
            width: 100%;
            height: 35px;
            line-height: 35px;
        }
        .top-list .top_type{
            width: 100%;
        }
        .top-list .top_type .type_li{
            width: 15%;
            text-align: left;
        }
        .top-list .top_type .type_li span{
            width: 1.7rem;margin-left: -8px;
            text-align: center;
            height: 24px;
            line-height: 24px;
        }
        .top-list .swiper-wrapper .top-span{
            margin-left: -8px;
            width: 100%;
            height: 20px;
            line-height: 20px;
        }
        .top-list .top_span span{
            width: 1.7rem;
            text-align: center;
            height: 24px;
            line-height: 24px;
        }
        /* .type_li {
            width: 23%;
        }

        .type_li span {
            width: 100%;
            overflow: hidden;
            min-width: 50px;
            line-height: 20px;
            height: 20px;
            text-align: center;
        }

        .swiper-slide.top_span span {
            width: 23%;
            overflow: hidden;
            min-width: 50px;
            line-height: 20px;
            height: 20px;
            text-align: center;
        } */
        [ng-cloak]{display: none;}
    </style>
</head>
<body ng-controller="DataController" ng-cloak>
<div class="swiper-container top-list" id="swiper1">
    <div class="swiper-wrapper top_type" id="fengqiang">
        <div class="swiper-slide type_li" style="text-align: center;">
            <span class=" huang_se" ng-click="ceshi('')">全部</span>
        </div>
        <div class="swiper-slide type_li" ng-repeat="t in topList">
            <span ng-click="ceshi(t.sortid)">{{ t.shortname }}</span>
        </div>
    </div>
</div>
<!-- <div class="swiper-container" id="swiper1">
    <div class="swiper-wrapper" id="fengqiang">
        <div class="swiper-slide">
            <span class="huang_se" >全部</span>
            <span >都市生活</span>
            <span >热血暧昧</span>
            <span >都市异能</span>
        </div>
        <div class="swiper-slide">
            <span >全部2</span>
            <span >都市生活2</span>
            <span >热血暧昧2</span>
            <span >都市异能3</span>
        </div>
        <div class="swiper-slide">
            <span >全部3</span>
            <span >都市生活3</span>
            <span >热血暧昧2</span>
            <span >都市异能3</span>
        </div>
    </div>
</div> -->
<div class="swiper-container top-list" id="swiper2">
    <div class="swiper-wrapper">
        <div class="swiper-slide top_span">
            <span class="huang_se" id="100" ng-click="zishus('','100')">全部</span>
            <span id="101" ng-click="zishus('1','101')">30万字以下</span>
            <span id="102" ng-click="zishus('2','102')">30-100万字</span>
            <span id="103" ng-click="zishus('3','103')">100万字以上</span>
        </div>
        <!--<div class="swiper-slide">
            <span >全部2</span>
            <span >都市生活2</span>
            <span >热血暧昧2</span>
            <span >都市异能3</span>
        </div>
        <div class="swiper-slide">
            <span >全部3</span>
            <span >都市生活3</span>
            <span >热血暧昧2</span>
            <span >都市异能3</span>
        </div>-->
    </div>
</div>
<div class=" top-list">
    <div class="redu top_span" style="background: #fff;">
        <span class="huang_se" style="margin-left: 3%;;" id="104" ng-click="xingshi('',104)">全部</span>
        <span id="105" ng-click="xingshi('0',105)">更新</span>
        <span id="106" ng-click="xingshi('3',106)">完结</span>
    </div>
</div>
<div class="booksList2" style="border-top:3px solid #ccc;">
    <ul>
        <li class="clearfix" ng-repeat="b in bookList" ng-click="bookdetail(b.articleid)">
            <div class="bookCover">
                <img src="{{imgurl + b.images}}" alt="" />
            </div>
            <div class="bookInfo">
                <p class="booksName">{{b.articlename}}</p>
                <p class="txt">
                    {{b.intro}}
                </p>
                <div class="author">
						<span style="    margin-right: 1em;">
							<!--<i class="iconfont">
								<img src="../image/authors.png" />
							</i>-->
							{{b.author}}
						</span>
                    <span class="labels" style="float: right;">
							{{b.shortname}}
						</span>
                    <span class="label" style="float: right;">
							{{(b.size/20).toFixed(1)}}万字
						</span>
                </div>
            </div>
        </li>
        <!--<li class="clearfix">
            <div class="bookCover">
                <img src="../image/book0.png" alt="" />
            </div>
            <div class="bookInfo">
                <p class="booksName">在时光尽头等你</p>
                <p class="txt">
                    小四有次在接受采访的时候提到齐名的死，他不是因为对易瑶的死内疚或是对森湘的死痛苦才自杀的
                    ，齐名总是
                </p>
                <div class="author">
                    <span>
                        <i class="iconfont"><img src="../image/authors.png"/></i>
                        倾城
                    </span>

                    <span class="labels">
                        都市言情
                    </span>
                    <span class="label">
                        10万字
                    </span>
                </div>
            </div>
        </li>
        <li class="clearfix">
            <div class="bookCover">
                <img src="../image/book0.png" alt="" />
            </div>
            <div class="bookInfo">
                <p class="booksName">在时光尽头等你</p>
                <p class="txt">
                    小四有次在接受采访的时候提到齐名的死，他不是因为对易瑶的死内疚或是对森湘的死痛苦才自杀的
                    ，齐名总是
                </p>
                <div class="author">
                    <span>
                        <i class="iconfont"><img src="../image/authors.png"/></i>
                        倾城
                    </span>

                    <span class="labels">
                        都市言情
                    </span>
                    <span class="label">
                        10万字
                    </span>
                </div>
            </div>
        </li><li class="clearfix">
            <div class="bookCover">
                <img src="../image/book0.png" alt="" />
            </div>
            <div class="bookInfo">
                <p class="booksName">在时光尽头等你</p>
                <p class="txt">
                    小四有次在接受采访的时候提到齐名的死，他不是因为对易瑶的死内疚或是对森湘的死痛苦才自杀的
                    ，齐名总是
                </p>
                <div class="author">
                    <span>
                        <i class="iconfont"><img src="../image/authors.png"/></i>
                        倾城
                    </span>

                    <span class="labels">
                        都市言情
                    </span>
                    <span class="label">
                        10万字
                    </span>
                </div>
            </div>
        </li><li class="clearfix">
            <div class="bookCover">
                <img src="../image/book0.png" alt="" />
            </div>
            <div class="bookInfo">
                <p class="booksName">在时光尽头等你</p>
                <p class="txt">
                    小四有次在接受采访的时候提到齐名的死，他不是因为对易瑶的死内疚或是对森湘的死痛苦才自杀的
                    ，齐名总是
                </p>
                <div class="author">
                    <span>
                        <i class="iconfont"><img src="../image/authors.png"/></i>
                        倾城
                    </span>

                    <span class="labels">
                        都市言情
                    </span>
                    <span class="label">
                        10万字
                    </span>
                </div>
            </div>
        </li>-->
    </ul>
</div>
<div class="bottom_loadmore"></div>
</body>
<script type="text/javascript" src="../script/jquery-2.1.4.js"></script>
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript" src="../script/common.js"></script>
<script src="../script/swiper.min.js"></script>
<!-- <script src="../script/angular.min.js"></script> -->
<script src="../script/ionic.bundle.js"></script>
<script src="../script/ev.js"></script>
<script type="text/javascript">
    var sortid,
        typeid,
        zongshu = 0,
        articletype,
        zishu,
        zifenid,
        ceshi;
    apiready = function() {
        sortid = api.pageParam.data.sortid;
        typeid = api.pageParam.data.types;


        EventT.emit('apiready');
        //getData(0);
    };
    $(function() {
        // var mySwiper2 = new Swiper('#swiper2', {
        // 	//			autoplay: 3000,//可选选项，自动滑动
        // 	slidesPerView: 1,
        // 	//			direction : 'vertical',
        // 	//          pagination: '.swiper-pagination',
        // 	paginationClickable: true,
        // 	spaceBetween: 0,
        // 	loop: false,
        // })
        $('.top_span').on('click', 'span', function() {
            $(this).addClass('huang_se').siblings().removeClass('huang_se');
        });
        //样式切换
        $('.top_type').on('click', 'span', function() {
            // 显示
            $(this).addClass('huang_se');
            $(this).parent('.type_li').siblings().find('span').removeClass('huang_se');
        });
    });
    var app = angular.module('myApp', []);
    app.controller('DataController', function($scope) { //angular开始
        $scope.bookList = [];
        $scope.imgurl = imageUrl;
        //获取小说列表
        function getData(page, callback) {
            //	alert(page);alert(articletype);alert(zifenid);alert(zishu);
            // console.log(page);
            // console.log(articletype);
            // console.log(zifenid);
            // console.log(zishu);
            console.log(typeid);
            $api.post(phpurl + 'Home/Book/sortdetail', {
                values : {
                    page        : page,
                    articletype : articletype,
                    sortid      : zifenid,
                    zishu       : zishu,
                    typeid      : typeid,
                },
            }, function(ret) {
                // console.log(JSON.stringify(ret))
                if (ret.code == 200) {
                    var result = ret.result;
                    // console.log(result.length)
                    if (page == 0) {
                        $scope.bookList = [];
                    }
                    if (ret.result.length > 0) {
                        $scope.bookList = $scope.bookList.concat(result);
                        // console.log(JSON.stringify($scope.bookList))
                    }
                    $scope.$apply();
                    callback && callback(ret);
                    $api.closeloadding();//关闭加载
                }
                $api.closeloadding();//关闭加载
            });
        }
        //获取导航列表
        function getTopData(callback) {
            // console.log(sortid)
            $api.post(phpurl + 'Home/Book/zisort', {
                values : {
                    sortid : sortid,
                },
            }, function(ret) {
                // console.log(JSON.stringify(ret))
                if (ret.code == 200) {
                    $scope.topList = ret.result.book_zisort_list2;
                    // console.log(JSON.stringify($scope.topList))
                    $scope.$apply();
                    var mySwiper1 = new Swiper('#swiper1', {
                        //			autoplay: 3000,//可选选项，自动滑动
                        slidesPerView       : 1,
                        //			direction : 'vertical',
                        //          pagination: '.swiper-pagination',
                        paginationClickable : true,
                        spaceBetween        : 0,
                        loop                : false,
                        slidesPerView       : 4,
                        slidesPerGroup      : 4,
                        centeredSlides      : true,
                        slidesOffsetBefore  : -130,
                        // observer: true, //修改swiper自己或子元素时，自动初始化swiper
                        // observeParents: true, //修改swiper的父元素时，自动初始化swiper
                    });
                    // setTimeout(function () {
                    // }, 1000);
                    // $api.closeloadding();//关闭加载
                } else {
                }
                callback && callback(ret);
                // $api.closeloadding();//关闭加载
            });
        }
        //获取导航分类id
        $scope.ceshi = function(n) {
            zifenid = n;
            getData(0);
        };
        //获取书籍字数
        $scope.zishus = function(n) {
            zishu = n;
            getData(0);
        };
        //获取书籍更新进度
        $scope.xingshi = function(n) {
            articletype = n;
            getData(0);
        };
        $scope.bookdetail = function(dates) {
            api.openWin({
                name      : dates + 'win_he_shu_sd',
                url       : 'dtail.html',
                pageParam : {
                    data : {
                        bookid : dates,
                    },
                },
            });
        };
        EventT.on('apiready', function() {
            getTopData();
            getData(0);
            $api.up(function(page, callback) {
                getData(page, function(ret) {
                    callback && callback(ret);
                });
            });
            $api.pull(function(callback) {
                getData(0, function() {
                    callback && callback();
                });
            });
        });
    });
</script>
</html>
